<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Crescent International – Admin Dashboard</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #0b0b0b;
      color: white;
      margin: 0;
      padding: 0;
    }
    header {
      text-align: center;
      background: #111;
      padding: 20px;
      font-size: 24px;
      font-weight: bold;
      letter-spacing: 1px;
    }
    section {
      padding: 20px;
      border-bottom: 1px solid #222;
    }
    h2 {
      margin-bottom: 10px;
      border-bottom: 1px solid #333;
      padding-bottom: 5px;
    }
    .item {
      margin-bottom: 12px;
      padding: 10px;
      background: #141414;
      border-radius: 6px;
    }
    .item img {
      width: 80px;
      height: 60px;
      object-fit: cover;
      margin-right: 8px;
      border-radius: 4px;
    }
    .btn {
      background: #0078ff;
      color: white;
      border: none;
      padding: 6px 10px;
      border-radius: 4px;
      margin-right: 6px;
      cursor: pointer;
    }
    .btn-danger {
      background: #d22;
    }
    .btn:hover {
      opacity: 0.8;
    }
    input, textarea {
      background: #111;
      color: white;
      border: 1px solid #333;
      padding: 6px;
      width: 100%;
      margin-bottom: 8px;
      border-radius: 4px;
    }
  </style>
</head>
<body>
  <header>Crescent International – Admin Dashboard</header>

  <section id="facilities">
    <h2>Facilities</h2>
    <div id="facilities-list"></div>
    <textarea id="facilities-text" placeholder="Enter facility description..."></textarea>
    <button class="btn" onclick="addFacility()">Add Facility</button>
  </section>

  <section id="labs">
    <h2>Labs</h2>
    <div id="labs-list"></div>
    <textarea id="labs-text" placeholder="Enter lab description..."></textarea>
    <button class="btn" onclick="addLab()">Add Lab</button>
  </section>

  <section id="faculty">
    <h2>Faculty</h2>
    <div id="faculty-list"></div>
    <textarea id="faculty-text" placeholder="Enter faculty details..."></textarea>
    <button class="btn" onclick="addFaculty()">Add Faculty</button>
  </section>

  <script>
    // LocalStorage Keys
    const LS = {
      facilities: "facilitiesData",
      labs: "labsData",
      faculty: "facultyData"
    };

    // Helper: Convert file to base64
    function toBase64(file) {
      return new Promise((resolve, reject) => {
        const reader = new FileReader();
        reader.readAsDataURL(file);
        reader.onload = () => resolve(reader.result);
        reader.onerror = reject;
      });
    }

    // ---------- Generic Image Upload ----------
    async function uploadImage(sectionKey, index) {
      const input = document.createElement('input');
      input.type = 'file';
      input.accept = 'image/*';
      input.onchange = async () => {
        if (input.files.length) {
          const base64 = await toBase64(input.files[0]);
          const arr = JSON.parse(localStorage.getItem(sectionKey) || "[]");
          if (!arr[index].images) arr[index].images = [];
          arr[index].images.push(base64);
          localStorage.setItem(sectionKey, JSON.stringify(arr));
          renderSections();
        }
      };
      input.click();
    }

    // ---------- Add Functions ----------
    function addFacility() {
      const text = document.getElementById("facilities-text").value.trim();
      if (!text) return alert("Enter facility description!");
      const arr = JSON.parse(localStorage.getItem(LS.facilities) || "[]");
      arr.push({ text, images: [] });
      localStorage.setItem(LS.facilities, JSON.stringify(arr));
      document.getElementById("facilities-text").value = "";
      renderSections();
    }

    function addLab() {
      const text = document.getElementById("labs-text").value.trim();
      if (!text) return alert("Enter lab description!");
      const arr = JSON.parse(localStorage.getItem(LS.labs) || "[]");
      arr.push({ text, images: [] });
      localStorage.setItem(LS.labs, JSON.stringify(arr));
      document.getElementById("labs-text").value = "";
      renderSections();
    }

    function addFaculty() {
      const text = document.getElementById("faculty-text").value.trim();
      if (!text) return alert("Enter faculty details!");
      const arr = JSON.parse(localStorage.getItem(LS.faculty) || "[]");
      arr.push({ text, images: [] });
      localStorage.setItem(LS.faculty, JSON.stringify(arr));
      document.getElementById("faculty-text").value = "";
      renderSections();
    }

    // ---------- Delete and Image Removal ----------
    function deleteItem(sectionKey, index) {
      const arr = JSON.parse(localStorage.getItem(sectionKey) || "[]");
      arr.splice(index, 1);
      localStorage.setItem(sectionKey, JSON.stringify(arr));
      renderSections();
    }

    function removeImage(sectionKey, itemIndex, imgIndex) {
      const arr = JSON.parse(localStorage.getItem(sectionKey) || "[]");
      arr[itemIndex].images.splice(imgIndex, 1);
      localStorage.setItem(sectionKey, JSON.stringify(arr));
      renderSections();
    }

    // ---------- Render Sections ----------
    function renderSection(sectionKey, listId) {
      const list = document.getElementById(listId);
      const arr = JSON.parse(localStorage.getItem(sectionKey) || "[]");
      list.innerHTML = arr.map((item, i) => `
        <div class="item">
          <p>${item.text}</p>
          <div>
            ${(item.images || [])
              .map(
                (img, j) =>
                  <img src="${img}"/> <button class='btn btn-danger' onclick="removeImage('${sectionKey}',${i},${j})">Remove</button>
              )
              .join("")}
          </div>
          <button class="btn" onclick="uploadImage('${sectionKey}',${i})">Add Image</button>
          <button class="btn btn-danger" onclick="deleteItem('${sectionKey}',${i})">Delete</button>
        </div>
      `).join('') || "<p>No entries yet.</p>";
    }

    function renderSections() {
      renderSection(LS.facilities, "facilities-list");
      renderSection(LS.labs, "labs-list");
      renderSection(LS.faculty, "faculty-list");
    }

    renderSections();
  </script>
</body>
</html>
